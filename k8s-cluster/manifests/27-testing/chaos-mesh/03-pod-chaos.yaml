---
# PodChaos: Pod failure experiment
apiVersion: chaos-mesh.org/v1alpha1
kind: PodChaos
metadata:
  name: pod-failure-experiment
  namespace: chaos-testing
spec:
  action: pod-failure
  mode: fixed
  value: "1"
  duration: "60s"
  selector:
    namespaces:
      - default
      - chaos-target
    labelSelectors:
      "chaos-test": "enabled"
  scheduler:
    cron: "@every 6h"

---
# PodChaos: Pod kill experiment
apiVersion: chaos-mesh.org/v1alpha1
kind: PodChaos
metadata:
  name: pod-kill-experiment
  namespace: chaos-testing
spec:
  action: pod-kill
  mode: fixed-percent
  value: "20"
  selector:
    namespaces:
      - chaos-target
    labelSelectors:
      "chaos-test": "enabled"
      "tier": "frontend"
  scheduler:
    cron: "0 */4 * * *"  # Every 4 hours

---
# PodChaos: Container kill experiment
apiVersion: chaos-mesh.org/v1alpha1
kind: PodChaos
metadata:
  name: container-kill-experiment
  namespace: chaos-testing
spec:
  action: container-kill
  mode: one
  containerNames:
    - "main"
  selector:
    namespaces:
      - chaos-target
    labelSelectors:
      "chaos-test": "enabled"
  duration: "30s"

---
# Schedule for regular pod chaos testing
apiVersion: chaos-mesh.org/v1alpha1
kind: Schedule
metadata:
  name: scheduled-pod-chaos
  namespace: chaos-testing
spec:
  schedule: "0 3 * * 6"  # Every Saturday at 3 AM
  historyLimit: 5
  concurrencyPolicy: Forbid
  type: PodChaos
  podChaos:
    action: pod-kill
    mode: fixed-percent
    value: "10"
    selector:
      namespaces:
        - chaos-target
      labelSelectors:
        chaos-test: enabled
